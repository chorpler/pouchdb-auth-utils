{"version":3,"file":"index.js","sources":["../node_modules/tslib/tslib.es6.js","../src/AuthError.ts","../src/utils.ts","../src/admins.ts","../src/authentication.ts","../src/users.ts","../src/plugin.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","export class AuthError extends Error {\n  public status:number = 400;\n  public name:string = \"authentication_error\";\n  // public message:string = \"\";\n  public error:string|boolean = true;\n  public taken:boolean = false;\n  public reason?:string = \"\";\n  public toJSON:Function;\n  public toJson:Function;\n  // public error?:string = \"\";\n  // public \n  constructor(msg:string, ...params) {\n    super(msg);\n    let self = this;\n\n    if(msg) {\n      this.message = msg;\n    }\n    if(typeof Error !== 'undefined' && typeof Error.captureStackTrace === 'function') {\n      // Error.captureStackTrace(this, AuthError);\n      // Error.captureStackTrace(this);\n      Error.captureStackTrace(self, AuthError);\n      // Error.captureStackTrace(self, self.constructor);\n    }\n    if(!this.reason) {\n      this.reason = this.message;\n    }\n    this.toJSON = () => {\n      // debuglog(`AuthError.toJSON() called`);\n      let out:any = Object.assign({}, this);\n      out.message = this.message + \"\";\n      // console.log(`AuthError.toJSON() called. Returning:`, out);\n      return out;\n    };\n    this.toJson = () => {\n      return this.toJSON();\n    };\n    return this;\n  }\n}\n","import   * as PouchDB            from \"pouchdb-core\"         ;\nimport { Response as nResponse } from \"node-fetch\"           ;\nimport { RequestInit           } from \"node-fetch\"           ;\nimport fetch                     from \"node-fetch\"           ;\n// import { Headers as nHeaders   } from \"node-fetch\"           ;\nimport   fetchCookie             from 'fetch-cookie'         ;\n// import   * as tough              from 'tough-cookie'         ;\nimport { btoa                  } from \"pouchdb-binary-utils\" ;\n// import { fetch as pFetch       } from 'pouchdb-fetch'        ;\nimport { fetch as pFetch       } from 'pouchdb'        ;\nimport { Headers               } from \"pouchdb-fetch\"        ;\nimport { assign, parseUri      } from \"pouchdb-utils\"        ;\nimport { AuthError             } from './AuthError'          ;\n// import * as URLParse from 'url-parse';\n// import URLParse = require('url-parse');\n// import URLParse = require('url-parse');\nimport * as URLParse from 'url-parse';\nimport   Url           from 'url-parse'            ;\n// import { Url                   } from 'url-parse'            ;\n\n// import { URL as wURL           } from 'whatwg-url'           ;\n\n// import * as Urlp from 'url-parse';\n// import URLParse = require('url-parse');\n\nconst g = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : {};\n// var Cookie = tough.Cookie;\n// type ParsedURL = Url.ParsedURL;\n// const Url = (URLParse.default);\n// const Url = URLParse;\n\ntype ParsedURL = URLParse.ParsedURL;\nconst emptyFunc = function(...args):any {};\nconst fakeUrl = {\n  new: emptyFunc,\n  // (address: string, parser?: boolean | URLParse.QueryParser): URLParse.ParsedURL;\n  // (address: string, location?: string | object, parser?: boolean | URLParse.QueryParser): URLParse.ParsedURL;\n\n  extractProtocol: emptyFunc,\n  location: emptyFunc,\n  qs: {\n      parse: emptyFunc,\n      stringify: emptyFunc,\n  },\n};\n// const Url = URLParse && typeof URLParse.default !== 'undefined' ? URLParse.default : URLParse && typeof URLParse.location !== 'undefined' ? URLParse : fakeUrl;\n\n\nconst nodeFetch = fetch;\n// const nodeFetch = pFetch;\nconst nFetch = nodeFetch;\nconst cFetch:Fetch = fetchCookie(nodeFetch);\nconst mode = typeof window !== 'undefined' ? 'browser' : 'node';\n\nconst StaticPouch:any = PouchDB;\n\nconst fet = typeof g['fetch'] === 'function' ? g['fetch'] : cFetch;\n// const fet = typeof g['fetch'] === 'function' ? g['fetch'] : nFetch;\n// const URL = typeof g['URL'] === 'function' ? g['URL'] : wURL;\n\ninterface ParsedURI {\n  anchor     : string;\n  authority  : string;\n  directory  : string;\n  file       : string;\n  host       : string;\n  password  ?: string;\n  path       : string;\n  port       : string;\n  protocol   : string;\n  query     ?: string;\n  queryKey  ?: any   ;\n  relative   : string;\n  source     : string;\n  user      ?: string;\n  userInfo  ?: string;\n}\n\ninterface AuthHeader {\n  username?:string;\n  password?:string;\n}\n\ninterface PDBOpts {\n  adapter?:string;\n  skip_setup?:boolean;\n  auth?:AuthHeader;\n  prefix?:string;\n  deterministic_revs?:boolean;\n  name?:string;\n}\n\ninterface UserContext {\n  name: string;\n  roles?: string[];\n}\n\ninterface User extends UserContext {\n}\n\ninterface PouchDBUserDoc extends User {\n  _id?:string;\n  _rev?:string;\n  [propName:string]:any;\n}\n\ninterface LoginResponse extends PouchDB.Core.BasicResponse, UserContext {\n}\n\ninterface SessionResponse extends PouchDB.Core.BasicResponse {\n  info: {\n    authenticated: string;\n    authentication_db: string;\n    authentication_handlers: string[];\n  };\n  userCtx: UserContext;\n}\n\ninterface PutUserOptions extends PouchDB.Core.Options {\n  metadata?: any;\n  roles?: string[];\n}\n\ninterface CouchNodeMembership {\n  all_nodes:string[];\n  cluster_nodes:string[];\n}\n\ninterface Database<Content extends {} = {}> extends PouchDB.Static {\n    /**\n     * Log in an existing user.\n     * Throws an error if the user doesn't exist yet, the password is wrong, the HTTP server is unreachable, or a meteor struck your computer.\n     */\n  logIn(username: string, password: string, options?: PouchDB.Core.Options): Promise<LoginResponse>;\n\n  /**\n   * Logs out whichever user is currently logged in.\n   * If nobody's logged in, it does nothing and just returns `{\"ok\" : true}`.\n   */\n  logOut(): Promise<PouchDB.Core.BasicResponse>;\n\n  /**\n   * Returns information about the CouchDB node membership of the server for the current database.\n   */\n  getMembership(options?:LoginOptions):Promise<CouchNodeMembership>;\n\n  /**\n   * Returns information about the current session.\n   * In other words, this tells you which user is currently logged in.\n   */\n  getSession(): Promise<SessionResponse>;\n\n  /**\n   * Sign up a new user who doesn't exist yet.\n   * Throws an error if the user already exists or if the username is invalid, or if some network error occurred.\n   * CouchDB has some limitations on user names (e.g. they cannot contain the character `:`).\n   */\n  signUp(username: string, password: string, options?: PutUserOptions): Promise<PouchDB.Core.Response>;\n\n  /**\n   * Returns the user document associated with a username.\n   * (CouchDB, in a pleasing show of consistency, stores users as JSON documents in the special `_users` database.)\n   * This is the primary way to get metadata about a user.\n   */\n  getUser(username: string, options?: PouchDB.Core.Options):Promise<PouchDB.Core.Document<Content & User> & PouchDB.Core.GetMeta>;\n  // getUser(username: string, options?: PouchDB.Core.Options):Promise<PouchDBUserDoc>;\n\n  /**\n   * Update the metadata of a user.\n   */\n  putUser(username: string, options?: PutUserOptions): Promise<PouchDB.Core.Response>;\n\n  /**\n   * Delete a user.\n   */\n  deleteUser(username: string, options?: PouchDB.Core.Options): Promise<PouchDB.Core.Response>;\n\n  /**\n   * Set new `password` for user `username`.\n   */\n  changePassword(username: string, password: string, options?: PouchDB.Core.Options): Promise<PouchDB.Core.Response>;\n\n  /**\n   * Renames `oldUsername` to `newUsername`.\n   */\n  changeUsername(oldUsername: string, newUsername: string, options?: PouchDB.Core.Options): Promise<PouchDB.Core.Response>;\n\n  /**\n   * Test if user `username` has role `role`.\n   */\n  hasRole(username: string, role: string, options?: PutUserOptions): Promise<boolean>;\n\n  /**\n   * Add roles `roles` to user `username`. `roles` can be a single string or an array of strings.\n   * If any of the provided roles already exist for the user, they will not be duplicated.\n   */\n  addRoles(username: string, roles: string[], options?: PutUserOptions): Promise<PouchDB.Core.Response>;\n  addRoles(username: string, roles: string, options?: PutUserOptions): Promise<PouchDB.Core.Response>;\n\n  /**\n   * Delete roles `roles` from user `username`. `roles` can be a single string or an array of strings.\n   * If any of the provided roles do not exist for the user, they will be ignored (will not cause an error)\n   */\n  deleteRoles(username: string, roles: string[], options?: PutUserOptions): Promise<PouchDB.Core.Response>;\n  deleteRoles(username: string, roles: string, options?: PutUserOptions): Promise<PouchDB.Core.Response>;\n\n  /**\n   * Sign up a new admin.\n   */\n  signUpAdmin(username: string, password: string, options?: PutUserOptions): Promise<string>;\n\n  /**\n   * Delete an admin.\n   */\n  deleteAdmin(username: string, options?: PouchDB.Core.Options): Promise<string>;\n}\n\ntype PouchDatabase = Database<any>;\n\ninterface PDB extends PouchDatabase {\n  __opts:PDBOpts;\n  prefix?:string;\n  type():string;\n}\n\ndeclare const window:any;\n\nconst debuglog = function(...args) {\n  // if(window && (window.PouchDB && window.PouchDB.debug && typeof window.PouchDB.debug.enabled === 'function' && window.PouchDB.debug.enabled('pouchdb:authentication'))) {\n  // if(window && window.PouchDB && typeof window.PouchDB.emit === 'function' && window.pouchdbauthenticationplugindebug) {\n  //   window.PouchDB.emit('debug', ['authentication', ...args]);\n  //   console.log(...args);\n  // }\n  let g;\n  if(typeof window !== 'undefined') {\n    g = window;\n  } else if(typeof global !== 'undefined') {\n    g = global;\n  }\n  if(!g) {\n    return;\n  }\n  if(typeof PouchDB !== 'undefined' && typeof PouchDB.emit === 'function') {\n    PouchDB.emit('debug', ['authentication', ...args]);\n  }\n  if(g && g['pouchdbauthenticationplugindebug'] === true && typeof console !== 'undefined' && typeof console.log === 'function') {\n    console.log(...args);\n  }\n}\n\nconst debugloggroup = function(label) {\n  let g;\n  if(typeof window !== 'undefined') {\n    g = window;\n  } else if(typeof global !== 'undefined') {\n    g = global;\n  }\n  if(!g) {\n    return;\n  }\n  if(g && g['pouchdbauthenticationplugindebug'] === true && typeof console !== 'undefined' && typeof console.groupCollapsed === 'function') {\n    console.groupCollapsed(label);\n  }\n}\n\nconst debugloggroupend = function() {\n  let g;\n  if(typeof window !== 'undefined') {\n    g = window;\n  } else if(typeof global !== 'undefined') {\n    g = global;\n  }\n  if(!g) {\n    return;\n  }\n  if(g && g['pouchdbauthenticationplugindebug'] === true && typeof console !== 'undefined' && typeof console.groupEnd === 'function') {\n    console.groupEnd();\n  }\n}\n\nconst debuglogemph = function(msg) {\n  // if(window && (window.PouchDB && window.PouchDB.debug && typeof window.PouchDB.debug.enabled === 'function' && window.PouchDB.debug.enabled('pouchdb:authentication'))) {\n  // if(window && window.PouchDB && typeof window.PouchDB.emit === 'function' && window.pouchdbauthenticationplugindebug) {\n  //   window.PouchDB.emit('debug', ['authentication', ...args]);\n  //   console.log(...args);\n  // }\n  let g;\n  if(typeof window !== 'undefined') {\n    g = window;\n  } else if(typeof global !== 'undefined') {\n    g = global;\n  }\n  if(!g) {\n    return;\n  }\n  if(g && g['pouchdbauthenticationplugindebug'] === true) {\n    const es:string = \"background-color:red; color:white;\";\n    if(typeof PouchDB !== 'undefined' && typeof PouchDB.emit === 'function') {\n      PouchDB.emit('debug', ['authentication', msg]);\n    }\n    if(typeof console !== 'undefined' && typeof console.log === 'function') {\n      if(g.chrome) {\n        console.log(\"%c\" + msg, es);\n      } else {\n        console.log(msg);\n      }\n    }\n  }\n}\n\nconst debugerr = function(...args) {\n  // if(window && (window.PouchDB && window.PouchDB.debug && typeof window.PouchDB.debug.enabled === 'function' && window.PouchDB.debug.enabled('pouchdb:authentication'))) {\n  // if(window && window.PouchDB && typeof window.PouchDB.emit === 'function' && window.pouchdbauthenticationplugindebug) {\n  //   window.PouchDB.emit('debug', ['authentication', ...args]);\n  //   console.error(...args);\n  // }\n  let g;\n  if(typeof window !== 'undefined') {\n    g = window;\n  } else if(typeof global !== 'undefined') {\n    g = global;\n  }\n  if(!g) {\n    return;\n  }\n  let errs, strError, jsonError = {};\n  if(g && (g.pouchdbauthenticationplugindebug || (typeof PouchDB !== 'undefined' && typeof PouchDB.emit === 'function'))) {\n    errs = [...args];\n    for(let err of errs) {\n      if(err instanceof AuthError) {\n        jsonError = err.toJSON();\n        strError = JSON.stringify(jsonError);\n        break;\n      } else if(err instanceof Error) {\n        strError = JSON.stringify(err);\n        jsonError = JSON.parse(strError);\n        if(strError === '{}') {\n          jsonError = {\n            message: err.message || \"unknown_error_message\",\n            name: err.name || \"unknown_error_name\",\n            stack: err.stack || \"unknown_error_stack\",\n          };\n          strError = JSON.stringify(jsonError);\n        }\n        // else {\n\n        // }\n        break;\n      }\n    }\n  }\n  if(typeof PouchDB !== 'undefined' && typeof PouchDB.emit === 'function') {\n    PouchDB.emit('debug', ['authentication', \"ERROR\", ...args]);\n    PouchDB.emit('debug', ['authentication', \"STRERROR\", strError]);\n  }\n  if(g && g['pouchdbauthenticationplugindebug'] === true && typeof console !== 'undefined' && typeof console.log === 'function' && typeof console.error === 'function') {\n    const errcss:string = \"font-weight: bold; background-color: rgba(255, 0, 0, 0.25);\";\n    if(errs[0]) {\n      if(errs[0] instanceof AuthError) {\n        console.log(\"%cPDBAUTH AUTHERROR:\", errcss, jsonError);\n        console.error(errs[0]);\n      } else if(errs[0] instanceof Error) {\n        console.log(\"%cPDBAUTH ERROR: \", errcss, jsonError);\n        console.error(errs[0]);\n      } else {\n        console.error(\"%cPDBAUTH ERROR 1?: \", errcss, strError);\n      }\n    } else {\n      console.error(\"%cPDBAUTH ERROR 2?: \", errcss, strError);\n    }\n  }\n}\n  // let err = [...args] || [{}];\n\nconst getBaseUrl = function(db:PDB):string {\n  // Use PouchDB.defaults' prefix, if any\n  let fullName:string;\n  let dbname:string = db.name;\n  // let type:string = db.type();\n  let prefix:string = db && db.__opts && typeof db.__opts.prefix === 'string' ? db.__opts.prefix : '';\n  if(prefix) {\n    fullName = prefix + (prefix.endsWith('/') ? '' : '/') + dbname;\n  } else {\n    fullName = dbname;\n  }\n\n  // let uri:ParsedURI = parseUri(fullName);\n  let p:ParsedURL = new Url(fullName);\n  let path:string = p.pathname;\n  let normalizedPath:string = path.endsWith('/') ? path.slice(0, -1) : path;\n  // Compute parent path for databases not hosted on domain root (see #215)\n  let parentPath:string = normalizedPath.split('/').slice(0,-1).join('/');\n  // let port:string = p.port ? \":\" + p.port : \"\";\n  let baseUrl:string = `${p.origin}${parentPath}`;\n\n  // let path:string = uri.path;\n  // let normalizedPath:string = path.endsWith('/') ? path.substr(0, -1) : path;\n  // let parentPath:string = normalizedPath.split('/').slice(0, -1).join('/');\n  // let portString:string = uri.port ? `:${uri.port}` : '';\n  // let baseURL:string = `${uri.protocol}://${uri.host}${portString}${parentPath}`;\n  // // let baseURL:string = uri.protocol + '://' + uri.host + (uri.port ? ':' + uri.port : '') + parentPath;\n  \n  // console.log(`getBaseUrl(): Base URL is '${baseURL}'`);\n  debuglog(`getBaseUrl(): Base URL is '${baseUrl}'`);\n  return baseUrl;\n}\n\nconst getDatabaseUrl = function(db:PDB):string {\n  let fullName:string;\n  let dbname:string = db.name;\n  // let type:string = db.type();\n  let prefix:string = db && db.__opts && typeof db.__opts.prefix === 'string' ? db.__opts.prefix : '';\n  if(prefix) {\n    fullName = prefix + (prefix.endsWith('/') ? '' : '/') + dbname;\n  } else {\n    fullName = dbname;\n  }\n  debuglog(`getDatabaseUrl(): Database URL is '${fullName}'`);\n  return fullName;\n}\n\nconst getRelativeComplexUrl = function(db:PDB, url:string):string {\n  let dbBaseURL:string = getDatabaseUrl(db);\n  let complexBaseUrl:string = makeBaseUrl(dbBaseURL, url);\n  let dbname:string = db && db.name ? db.name : \"UNKNOWN_POUCHDB_NAME\";\n  debuglog(`getRelativeComplexUrl(): Relative complex URL for database '${dbname}' and URL '${url}' is '${complexBaseUrl}'`);\n  return complexBaseUrl;\n}\n\nconst getComplexBaseUrl = function(db:PDB, url:string):string {\n  let dbBaseURL:string = getDatabaseUrl(db);\n  let complexBaseUrl:string = makeBaseUrl(dbBaseURL, url);\n  let dbname:string = db && db.name ? db.name : \"UNKNOWN_POUCHDB_NAME\";\n  debuglog(`getComplexBaseUrl(): Complex base URL for database '${dbname}' and URL '${url}' is '${complexBaseUrl}'`);\n  return complexBaseUrl;\n}\n\nconst makeBaseUrl = function(baseURL:string, newURL:string):string {\n  // let newuri : ParsedURI = parseUri(newURL);\n  // let puri   : ParsedURI = parseUri(baseURL);\n  let outurl:string = \"\";\n  baseURL = baseURL.slice(-1) === '/' ? baseURL.slice(0,-1) : baseURL;\n  let baseuri:ParsedURL = new Url(baseURL);\n  let puri:ParsedURL = new Url(newURL, baseURL);\n  let relativePath:string = puri.pathname + puri.query;\n  // let outurl:string = getURLWithoutSearchParams(baseURL);\n  // outurl = outurl.slice(-1) === '/' ? outurl.slice(0,-1) : outurl;\n  // let dir1:string = puri.directory + puri.file;\n  let dir1:string = baseuri.pathname;\n  let dirs:string[] = dir1.split('/');\n  let len   : number = dirs.length;\n  let last  : number = len - 1;\n  let count : number = dirs[last] === \"\" ? len - 2 : len - 1;\n  for (let i = 0; i < count; i++) {\n    outurl += \"../\";\n  }\n  let addedpath:string = relativePath.slice(0,1) === '/' ? relativePath.slice(1) : relativePath;\n  let newfile:string = addedpath;\n  outurl += newfile;\n  outurl = outurl.slice(0,1) === '/' ? outurl.slice(1) : outurl;\n  debuglog(`makeBaseUrl(): Complicated base URL from '${baseURL}' and '${newURL}' is '${outurl}'`);\n  return outurl;\n}\n\nfunction getURLWithoutSearchParams(url:string):string {\n  let uri:ParsedURI = parseUri(url);\n  let cleanURL:string = uri.protocol + \"://\" + uri.authority + uri.directory + uri.file;\n  return cleanURL;\n}\n\nfunction getBasicAuthTokenFor(username:string, password:string):string {\n  let authString:string = username + \":\" + password;\n  let token:string = btoa(decodeURIComponent(encodeURIComponent(authString)));\n  return token;\n}\n\nfunction getBasicAuthStringFor(username:string, password:string):string {\n  let token:string = getBasicAuthTokenFor(username, password);\n  let authString:string = \"Basic \" + token;\n  return authString;\n}\n\nfunction getBasicAuthHeadersFor(username:string, password:string):Headers {\n  let authString:string = getBasicAuthStringFor(username, password);\n  let headers:Headers = new Headers();\n  headers.set('Authorization', authString);\n  return headers;\n}\n\nconst getBasicAuthHeaders = function(db?:PDB):Headers {\n  let auth:AuthHeader;\n  if(!db) {\n    return new Headers();\n  }\n  if(db.__opts && db.__opts.auth) {\n    auth = db.__opts.auth;\n  } else {\n    let uri:any = parseUri(db.name);\n    if(uri.user || uri.password) {\n      auth = {\n        username: uri.user,\n        password: uri.password,\n      };\n    }\n  }\n\n  if(!auth) {\n    return new Headers();\n  }\n\n  return getBasicAuthHeadersFor(auth.username, auth.password);\n  // let str:string = auth.username + ':' + auth.password;\n  // let token:string = btoa(decodeURIComponent(encodeURIComponent(str)));\n\n  // let headers:Headers = new Headers();\n  // headers.set('Authorization', 'Basic ' + token);\n\n  // return headers;\n}\n\nfunction getFullFetchURL(db:PDB, url:string):string {\n  let base:string = getBaseUrl(db);\n  let queryURL:string = url.startsWith(\"/\") ? url : \"/\" + url;\n  let fullURL:string = base + queryURL;\n  // let p:ParsedURI = parseUri(fullURL);\n  let p:ParsedURL = new Url(queryURL, base);\n  // let port:string = p.port ? \":\" + p.port : \"\";\n  // let fetchURL:string = `${p.protocol}://${p.host}${port}${p.path}`;\n  let fetchURL = p.href;\n  return fetchURL;\n}\n\nasync function doFetch(db:PDB, url:string, opts:any, forceDBFetch?:boolean):Promise<any> {\n  try {\n    opts = assign(opts || {});\n    // let dbname = db && typeof db.fetch === 'function' \n    let dbname:string = getDatabaseUrl(db);\n    // let groupLabel:string = `doFetch() called for DB '${dbname}' and URL '${url}' …`;\n    let groupLabel:string = `doFetch() called for DB '${dbname}' and URL '${url}' and options:`;\n    debuglog(groupLabel, opts);\n    // debugloggroup(groupLabel);\n    // debuglog(`doFetch(): Full DB is:`, db);\n    // debuglog(`doFetch(): Called with url '${url}'`);\n    debuglog(`doFetch(): Called with opts:`, opts);\n    // debugloggroupend();\n    let full:boolean = true;\n    let newurl:string;\n    let baseURL:string;\n    let res:Response;\n    let RESERVED_KEYS:string[] = [\n      '/_config',\n      '/_users',\n      '/_session',\n      '/_active_tasks',\n      '/_all_dbs',\n      '/_dbs_info',\n      '/_cluster_setup',\n      '/_db_updates',\n      '/_membership',\n      '/_replicate',\n      '/_scheduler',\n      '/_node',\n      '/_utils',\n      '/_up',\n      '/_uuids',\n      '/favicon.ico',\n    ];\n\n    // if(RESERVED_KEYS.indexOf(url) > -1) {\n    //   baseURL = getBaseUrl(db);\n    // } else {\n    //   baseURL = db.name;\n    // }\n    for(let key of RESERVED_KEYS) {\n      if(url.includes(key)) {\n      // if(url.startsWith(key)) {\n        full = false;\n      }\n    }\n    if(full) {\n      // baseURL = db.name;\n      baseURL = getDatabaseUrl(db);\n    } else {\n      baseURL = url;\n      // baseURL = getBaseUrl(db);\n      // baseURL = getComplexBaseUrl(db, url);\n    }\n    // newurl = baseURL;\n\n    // let fullURL = new URL(baseURL, dbname);\n    // newurl = fullURL.href;\n    let dbURL:ParsedURL = new Url(dbname);\n    let fullURL:ParsedURL = new Url(baseURL, dbname);\n    let fetchURL:string = getFullFetchURL(db, baseURL);\n    newurl = fetchURL;\n    \n\n\n    // if(url[0] === \"/\") {\n    //   newurl = baseURL + url;\n    // } else {\n    //   newurl = baseURL + \"/\" + url;\n    // }\n\n\n    // if(url[0] === '/') {\n    //   newurl = \"..\" + url;\n    // }\n\n    // let dbname:string = db.name;\n    // newurl = url;\n    // console.log(`doFetch(): DB is: `, db);\n    \n    if(opts.body && typeof opts.body !== 'string') {\n      opts.body = JSON.stringify(opts.body);\n      // opts.body = JSON.stringify(opts.body);\n    }\n    if(dbURL.username) {\n      let authString:Headers = getBasicAuthStringFor(dbURL.username, dbURL.password);\n      let headers:Headers = new Headers(opts.headers);\n      headers.set(\"Authorization\", authString);\n      opts.headers = headers;\n      // newurl = fullURL.origin + fullURL.pathname + fullURL.search;\n    }\n    \n    // console.log(`doFetch(): DB is '${dbname}'`);\n    // console.log(`doFetch(): URL is: `, url);\n    // console.log(`doFetch(): opts is: `, opts);\n    let g:any = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : null;\n    if(forceDBFetch || (g && g.forceDBFetch === true)) {\n      let relativeURL:string = getRelativeComplexUrl(db, url);\n      let css:string = \"border: 5px dotted green; background-color: rgba(0, 255, 255, 0.3); padding: 5px;\";\n      debuglog(`%cdoFetch(): FORCIBLY PouchDB.fetch'ing from url '${relativeURL}' with options:`, css, opts);\n      res = await db.fetch(relativeURL, opts);\n    } else if(full) {\n      // let res:Response = await db.fetch(newurl, opts);\n      debuglog(`doFetch(): PouchDB.fetch'ing from url '${url}' with options:`, opts);\n      res = await db.fetch(url, opts);\n    } else {\n      // res = await fetch(newurl, opts);\n      // res = await wFetch(newurl, opts);\n      // res = await pFetch(newurl, opts);\n      // res = await db.fetch(newurl, opts);\n      // let newHeaders:string[][] = [];\n      \n      if(mode === 'node') {\n        let newHeaders:any = {};\n        let headers = opts && opts.headers && opts.headers.entries ? opts.headers.entries() : [];\n        for(let entry of headers) {\n          let key:string = entry[0];\n          let value:string = entry[1];\n          // newHeaders.push([key, value]);\n          newHeaders[key] = value;\n        }\n  \n        let nFetchOpts:RequestInit = assign({}, opts);\n        let hdrs:Headers = new Headers(newHeaders);\n        // let hdrs:Headers = new nHeaders(newHeaders);\n        // nFetchOpts.headers = newHeaders;\n        nFetchOpts.headers = hdrs;\n        // res = await nFetch(newurl, opts);\n        debuglog(`doFetch(): Node-Fetch'ing from url '${newurl}' with options:`, nFetchOpts);\n        res = await fet(newurl, nFetchOpts);\n        // res = await pFetch(newurl, nFetchOpts);\n      } else {\n        debuglog(`doFetch(): Global-Fetch'ing from url '${newurl}' with options:`, opts);\n        res = await fet(newurl, opts);\n      }\n\n    }\n    if(fet !== nFetch) {\n      debuglog(`doFetch(): Response is: `, res);\n    } else {\n      let jsonRes = {\n        url: res.url,\n        ok: res.ok,\n        status: res.status,\n        statusText: res.statusText,\n      };\n      debuglog(`doFetch(): Response is: `, jsonRes);\n    }\n    // let res:Response = await db.fetch(newurl, opts);\n    // let res:Response = await StaticPouch.fetch(newurl, opts);\n    let ok:boolean = res.ok;\n    // console.log(`doFetch(): Fetch result:\\n`, res);\n    let content:any = await res.json();\n    // if(ok) {\n    //   callback(null, content);\n    // } else {\n    //   content.name = content.error;\n    //   callback(content);\n    // }\n    // return res;\n    if(ok) {\n      return content;\n    } else {\n      // let text:string = \"fetch result not ok\";\n      // let errText:string = content && typeof content.error === 'string' ? content.error : content && typeof content.message === 'string' ? content.message : typeof content === 'string' ? content : \"unknown_error\";\n      // let finalErrorText:string =  `${text}: '${errText}'`;\n      // let err:Error = new Error(finalErrorText);\n      // let err:Error = new Error(errText);\n      // throw err;\n      let msg:string = res && typeof res.statusText === 'string' ? res.statusText : \"unknown_error\";\n      let status:number = res && typeof res.status === 'number' ? res.status : 0;\n      let err:AuthError = new AuthError(msg);\n      err.status = status;\n      if(content) {\n        if(typeof content.error === 'string') {\n          err.name = content.error;\n          err.error = content.error;\n        }\n        if(typeof content.reason === 'string') {\n          err.reason = content.reason;\n        }\n      }\n      //  else if(msg === 'unknown_error') {\n      //   err.name = msg;\n      // }\n      // content.name = content.error;\n      throw err;\n    }\n  } catch(err) {\n    // console.log(`doFetch(): Fetch error:\\n`, err);\n    if(err && err.name === 'unknown_error') {\n      err.message = (err.message + ' ' || '') +\n          'Unknown error!  Did you remember to enable CORS?';\n    }\n    debuglog(`doFetch(): Error during fetch!`);\n    debugerr(err);\n    // callback(err);\n    throw err;\n  }\n}\n\n\n// function AuthError(message:string):void {\n//   this.status = 400;\n//   this.name = 'authentication_error';\n//   this.message = message;\n//   this.error = true;\n//   try {\n//     Error.captureStackTrace(this, AuthError);\n//   } catch (e) {}\n// }\n\n// inherits(AuthError, Error);\ntype LoginOptions = PouchDB.Core.Options;\ntype BasicResponse = PouchDB.Core.BasicResponse;\nexport {\n  mode,\n  fet,\n  nFetch,\n  debuglog,\n  debuglogemph,\n  debugloggroup,\n  debugloggroupend,\n  debugerr,\n  AuthError,\n  doFetch,\n  getBasicAuthHeadersFor,\n  getBasicAuthHeaders,\n  getBaseUrl,\n  AuthHeader,\n  PDBOpts,\n  UserContext,\n  User,\n  PDB,\n  PouchDBUserDoc,\n  LoginOptions,\n  LoginResponse,\n  BasicResponse,\n  SessionResponse,\n  PutUserOptions,\n  CouchNodeMembership,\n  parseUri,\n  getComplexBaseUrl,\n  getRelativeComplexUrl,\n  makeBaseUrl,\n  getURLWithoutSearchParams,\n  getFullFetchURL,\n  Url,\n  ParsedURL,\n};\n","import { AuthError              } from './utils'       ;\nimport { PDB                    } from './utils'       ;\nimport { PouchDBUserDoc         } from './utils'       ;\nimport { PutUserOptions         } from './utils'       ;\nimport { BasicResponse          } from './utils'       ;\nimport { LoginOptions           } from './utils'       ;\nimport { CouchNodeMembership    } from './utils'       ;\nimport { doFetch                } from './utils'       ;\nimport { getBasicAuthHeaders    } from './utils'       ;\nimport { getBasicAuthHeadersFor } from './utils'       ;\nimport { debuglog, debugerr     } from './utils'       ;\nimport { debuglogemph           } from './utils'       ;\nimport { Headers                } from 'pouchdb-fetch' ;\n// import { getBaseUrl             } from './utils'       ;\nimport { assign                 } from 'pouchdb-utils' ;\n// import { toPromise              } from 'pouchdb-utils' ;\n\nconst getConfigUrl = function(db:PDB, nodeName?:string):string {\n  return (nodeName ? '/_node/' + nodeName : '') + '/_config';\n}\n\nconst getMembership = async function(opts:LoginOptions):Promise<CouchNodeMembership> {\n  try {\n    let db:PDB = this;\n    let options:any = opts != undefined ? opts : {};\n    // let serverURL:string = getBaseUrl(db);\n    // let url:string = serverURL + '/_membership';\n    let url:string = '/_membership';\n    let ajaxOpts:any = assign({\n      method: 'GET',\n      headers: getBasicAuthHeaders(db),\n    }, options.ajax || {});\n    // console.log(`getMembership(): Fetching DB membership from URL '${url}'`);\n    let res:CouchNodeMembership = await doFetch(db, url, ajaxOpts);\n    // console.log(`getMembership(): DB membership is:\\n`, res);\n    return res;\n  } catch(err) {\n    throw err;\n  }\n};\n\nconst signUpAdmin = async function(username:string, password:string, opts:LoginOptions):Promise<BasicResponse> {\n  try {\n    debuglogemph(`PouchDB.signUpAdmin(): Called for '${username}'`);\n    let db:PDB = this;\n    let options:any = opts != undefined ? opts : {};\n    if(['http', 'https'].indexOf(db.type()) === -1) {\n      let err:AuthError = new AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB(\"http://mysite.com:5984/mydb\") instead.');\n      throw err;\n    } else if(!username) {\n      let err:AuthError = new AuthError('You must provide a username');\n      throw err;\n    } else if(!password) {\n      let err:AuthError = new AuthError('You must provide a password');\n      throw err;\n    }\n\n    let membership:CouchNodeMembership;\n    let nodeName:string;\n    try {\n      membership = await db.getMembership(options);\n      // This is a CouchDB 2.x server\n      nodeName = membership.all_nodes[0];\n    } catch(err) {\n      if(err.error && err.error === 'illegal_database_name') {\n        throw err;\n      } else {\n        // This could be a CouchDB 1.x server\n        nodeName = undefined;\n      }\n    }\n    let configUrl:string = getConfigUrl(db, nodeName);\n    // let headers:Headers = getBasicAuthHeadersFor(username, password);\n    let url:string = (options.configUrl || configUrl) + '/admins/' + encodeURIComponent(username);\n    let ajaxOpts:any = assign({\n      method: 'PUT',\n      processData: false,\n      headers: getBasicAuthHeaders(db),\n      // headers: headers,\n      body: '\"' + password + '\"',\n    }, options.ajax || {});\n    let res:BasicResponse = await doFetch(db, url, ajaxOpts);\n    return res;\n  } catch(err) {\n    throw err;\n  }\n};\n\nconst deleteAdmin = async function(username:string, opts:LoginOptions):Promise<BasicResponse> {\n  try {\n    debuglogemph(`PouchDB.deleteAdmin(): Called for '${username}'`);\n    let db:PDB = this;\n    let options:any = opts != undefined ? opts : {};\n    if(['http', 'https'].indexOf(db.type()) === -1) {\n      let err:AuthError = new AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB(\"http://mysite.com:5984/mydb\") instead.');\n      throw err;\n    } else if(!username) {\n      let err:AuthError = new AuthError('You must provide a username');\n      throw err;\n    }\n  \n    let membership:CouchNodeMembership;\n    let nodeName:string;\n    try {\n      membership = await db.getMembership(options);\n      // This is a CouchDB 2.x server\n      nodeName = membership.all_nodes[0];\n    } catch(err) {\n      if(err.error && err.error === 'illegal_database_name') {\n        throw err;\n      } else {\n        // This could be a CouchDB 1.x server\n        nodeName = undefined;\n      }\n    }\n    let configUrl:string = getConfigUrl(db, nodeName);\n    let url:string = (options.configUrl || configUrl) + '/admins/' + encodeURIComponent(username);\n    let headers:Headers = getBasicAuthHeaders(db);\n    let ajaxOpts:any = assign({\n      method: 'DELETE',\n      processData: false,\n      headers: headers,\n    }, options.ajax || {});\n    let noAuthAjaxOpts:any = assign({}, ajaxOpts);\n    delete noAuthAjaxOpts.headers;\n    let res:BasicResponse;\n    try {\n      res = await doFetch(db, url, ajaxOpts);\n      return res;\n    } catch(fetchErr) {\n      debuglogemph(`deleteAdmin(): Error deleting administ`)\n    }\n    return res;\n  } catch(err) {\n    throw err;\n  }\n};\n\nexport { getConfigUrl, getMembership, deleteAdmin, signUpAdmin };","import { AuthError              } from './utils'       ;\nimport { AuthHeader             } from './utils'       ;\nimport { PDB                    } from './utils'       ;\nimport { LoginOptions           } from './utils'       ;\nimport { LoginResponse          } from './utils'       ;\nimport { BasicResponse          } from './utils'       ;\nimport { SessionResponse        } from './utils'       ;\nimport { doFetch                } from './utils'       ;\nimport { getBasicAuthHeadersFor } from './utils'       ;\nimport { getBasicAuthHeaders    } from './utils'       ;\nimport { debuglog, debugerr     } from './utils'       ;\nimport { debuglogemph           } from './utils'       ;\nimport { assign, toPromise      } from 'pouchdb-utils' ;\nimport { Headers                } from 'pouchdb-fetch' ;\n\nconst logIn = async function(username:string, password:string, opts:LoginOptions):Promise<LoginResponse> {\n  try {\n    debuglogemph(`PouchDB.logIn(): Called for '${username}'`);\n    let db:PDB = this;\n    let options:any = opts != undefined ? opts : {};\n    if(['http', 'https'].indexOf(db.type()) === -1) {\n      // return callback(new AuthError('this plugin only works for the http/https adapter'));\n      let err:Error = new Error(\"pouchdb-authentication plugin only works for the http/https adapter\");\n      throw err;\n    }\n  \n    if(!username) {\n      // return callback(new AuthError('you must provide a username'));\n      let err:Error = new Error(\"you must provide a username\");\n      throw err;\n    } else if (!password) {\n      // return callback(new AuthError('you must provide a password'));\n      let err:Error = new Error(\"you must provide a password\");\n      throw err;\n    }\n  \n    let url:string = '/_session';\n    let headers:Headers = getBasicAuthHeadersFor(username, password);\n    headers.append('Content-Type', 'application/json');\n    let ajaxOpts:any = assign({\n      method: 'POST',\n      // headers: assign({'Content-Type': 'application/json'}, getBasicAuthHeaders(db)),\n      headers: headers,\n      body: {name: username, password: password},\n    }, options.ajax || {});\n\n    let res:LoginResponse = await doFetch(db, url, ajaxOpts);\n    if(db && db.__opts) {\n      if(db.__opts.auth) {\n        db.__opts.auth.username = username;\n        db.__opts.auth.password = password;\n      } else {\n        let auth:AuthHeader = {\n          username: username,\n          password: password,\n        };\n        db.__opts.auth = auth;\n      }\n    }\n    return res;\n  } catch(err) {\n    throw err;\n  }\n};\n\nconst logOut = async function(opts:LoginOptions):Promise<BasicResponse> {\n  try {\n    debuglogemph(`PouchDB.logOut(): Called`);\n    let db:PDB = this;\n    let options:any = opts != undefined ? opts : {};\n    let url:string = '/_session';\n    let ajaxOpts:any = assign({\n      method: 'DELETE',\n      headers: getBasicAuthHeaders(db),\n    }, options.ajax || {});\n  \n    let res:BasicResponse = await doFetch(db, url, ajaxOpts);\n    if(db && db.__opts && db.__opts.auth) {\n      delete db.__opts.auth;\n    }\n    return res;\n  } catch(err) {\n    try {\n      debuglog(`======> PouchDB.logOut(): Caught error trying to log out`);\n      debugerr(err);\n      debuglog(`======> PouchDB.logOut(): Retrying without authentication …`);\n      let db:PDB = this;\n      let options:any = opts != undefined ? opts : {};\n      let url:string = '/_session';\n      let noAuthAjaxOpts:any = assign({\n        method: 'DELETE',\n        // headers: getBasicAuthHeaders(db),\n      }, options.ajax || {});\n      delete noAuthAjaxOpts.headers;\n      let res:BasicResponse = await doFetch(db, url, noAuthAjaxOpts);\n      if(db && db.__opts && db.__opts.auth) {\n        delete db.__opts.auth;\n      }\n      debuglog(`======> PouchDB.logOut(): Successfully logged out after retrying without authentication headers.`);\n      return res;\n    } catch(err) {\n      throw err;\n    }\n  }\n};\n\nconst getSession = async function ():Promise<SessionResponse> {\n  try {\n    debuglogemph(`PouchDB.getSession(): Called`);\n    let db:PDB = this;\n    let url:string = '/_session';\n    let ajaxOpts:any = {\n      method: 'GET',\n      headers: getBasicAuthHeaders(db),\n    };\n    let res:SessionResponse = await doFetch(db, url, ajaxOpts);\n    return res;\n  } catch(err) {\n    throw err;\n  }\n};\n\nexport { logIn, logOut, getSession };\n","import { AuthError           } from './utils'       ;\nimport { PDB                 } from './utils'       ;\nimport { PouchDBUserDoc      } from './utils'       ;\nimport { PutUserOptions      } from './utils'       ;\nimport { BasicResponse       } from './utils'       ;\nimport { LoginOptions        } from './utils'       ;\nimport { doFetch             } from './utils'       ;\nimport { getBasicAuthHeaders } from './utils'       ;\nimport { getBaseUrl          } from './utils'       ;\nimport { debuglog, debugerr  } from './utils'       ;\nimport { debuglogemph        } from './utils'       ;\nimport { assign              } from 'pouchdb-utils' ;\nimport { clone               } from 'pouchdb-utils' ;\nimport { toPromise           } from 'pouchdb-utils' ;\n\n// import * as PouchDB from 'pouchdb-core';\n\nconst getUsersDatabaseUrl = function():string {\n  let db:PDB = this;\n  let userDBURL:string = getBaseUrl(db) + '/_users';\n  // console.log(`getUsersDatabaseUrl(): URL and DB is:\\n`, userDBURL);\n  // console.log(`getUsersDatabaseUrl(): DB is:`, db);\n  return userDBURL;\n};\n\nconst hasRole = async function(username:string, role:string, opts?:PutUserOptions):Promise<boolean> {\n  try {\n    let db:PDB = this;\n    debuglogemph(`PouchDB.hasRole(): Called for user '${username}'`);\n    let userdoc:PouchDBUserDoc = await db.getUser(username, opts);\n    let roles:string[] = userdoc.roles || [];\n    if(roles.indexOf(role) > -1) {\n      return true;\n    }\n    return false;\n  } catch(err) {\n    throw err;\n  }\n};\n\nconst getRoles = async function(username:string, opts?:PutUserOptions):Promise<string[]> {\n  try {\n    let db:PDB = this;\n    debuglogemph(`PouchDB.getRoles(): Called for user '${username}'`);\n    let userdoc:PouchDBUserDoc = await db.getUser(username, opts);\n    let roles:string[] = userdoc.roles || [];\n    return roles;\n  } catch(err) {\n    throw err;\n  }\n};\n\nconst addRoles = async function(username:string, roles:string|string[], opts?:PutUserOptions):Promise<BasicResponse> {\n  try {\n    let db:PDB = this;\n    debuglogemph(`PouchDB.addRoles(): Called for user '${username}' and role '${roles}'`);\n    let userdoc:PouchDBUserDoc = await db.getUser(username, opts);\n    let newRoles:string[] = userdoc.roles || [];\n    let rolesToAdd:string[] = Array.isArray(roles) ? roles : typeof roles === 'string' ? [roles] : [];\n    rolesToAdd = rolesToAdd.filter((a:string) => {\n      return typeof a === 'string';\n    });\n    for(let role of rolesToAdd) {\n      if(newRoles.indexOf(role) > -1) {\n        /* This role already exists for this user */\n        continue;\n      } else {\n        newRoles.push(role);\n      }\n    }\n    newRoles.sort();\n    userdoc.roles = newRoles;\n    let res:BasicResponse = await updateUser(db, userdoc, opts);\n    return res;\n  } catch(err) {\n    throw err;\n  }\n};\n\nconst deleteRoles = async function(username:string, roles:string|string[], opts?:PutUserOptions):Promise<BasicResponse> {\n  try {\n    let db:PDB = this;\n    debuglogemph(`PouchDB.deleteRoles(): Called for user '${username}' and role '${roles}'`);\n    let userdoc:PouchDBUserDoc = await db.getUser(username, opts);\n    let existingRoles:string[] = userdoc.roles || [];\n    let rolesToDelete:string[] = Array.isArray(roles) ? roles : typeof roles === 'string' ? [roles] : [];\n    let filteredExistingRoles:string[] = existingRoles.filter((a:string) => {\n      if(rolesToDelete.indexOf(a) > -1) {\n        return false;\n      } else {\n        return true;\n      }\n    });\n    userdoc.roles = filteredExistingRoles;\n    let res:BasicResponse = await updateUser(db, userdoc, opts);\n    return res;\n  } catch(err) {\n    throw err;\n  }\n};\n\nconst updateUser = async function(db:PDB, user:PouchDBUserDoc, opts:PutUserOptions):Promise<BasicResponse> {\n  try {\n    let id:string = user && typeof user._id === 'string' ? user._id : \"UNKNOWN_USER\";\n    debuglogemph(`PouchDB.updateUser(): Called for '${id}'`);\n    let options:any = opts != undefined ? opts : {};\n    let reservedWords:string[] = [\n      '_id',\n      '_rev',\n      'name',\n      'type',\n      'roles',\n      'password',\n      'password_scheme',\n      'iterations',\n      'derived_key',\n      'salt',\n    ];\n  \n    if(options.metadata) {\n      for(let key in options.metadata) {\n        if(options.metadata.hasOwnProperty(key) && reservedWords.indexOf(key) !== -1) {\n          let err:AuthError = new AuthError('cannot use reserved word in metadata: \"' + key + '\"');\n          throw err;\n        }\n      }\n      user = assign(user, options.metadata);\n    }\n  \n    if(options.roles) {\n      user = assign(user, {roles: options.roles});\n    }\n  \n    let url:string = '/_users/' + encodeURIComponent(user._id);\n    let ajaxOpts:any = assign({\n      method: 'PUT',\n      body: user,\n      headers: getBasicAuthHeaders(db),\n    }, options.ajax || {});\n  \n    let res:BasicResponse = await doFetch(db, url, ajaxOpts);\n    return res;\n  } catch(err) {\n    throw err;\n  }\n};\n\nconst signUp = async function (username:string, password:string, opts:PutUserOptions):Promise<BasicResponse> {\n  try {\n    debuglogemph(`PouchDB.signUp(): Called for '${username}'`);\n    let db:PDB = this;\n    let options:any = opts != undefined ? opts : {};\n    if(['http', 'https'].indexOf(db.type()) === -1) {\n      let err:AuthError = new AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB(\"http://mysite.com:5984/mydb\") instead.');\n      throw err;\n    } else if (!username) {\n      let err:AuthError = new AuthError('You must provide a username');\n      throw err;\n    } else if (!password) {\n      let err:AuthError = new AuthError('You must provide a password');\n      throw err;\n    }\n  \n    let userId:string = 'org.couchdb.user:' + username;\n    let user:PouchDBUserDoc = {\n      name: username,\n      password: password,\n      roles: [],\n      type: 'user',\n      _id: userId,\n    };\n  \n    let res:BasicResponse = await updateUser(db, user, options);\n    return res;\n  } catch(err) {\n    throw err;\n  }\n};\n\nconst getUser = async function(username:string, opts:LoginOptions):Promise<PouchDBUserDoc> {\n  try {\n    debuglogemph(`PouchDB.getUser(): Called for '${username}'`);\n    let db:PDB = this;\n    let options:any = opts != undefined ? opts : {};\n    if(!username) {\n      let err:AuthError = new AuthError('you must provide a username');\n      throw err;\n    }\n  \n    let url:string = '/_users/' + encodeURIComponent('org.couchdb.user:' + username);\n    let ajaxOpts:any = assign({\n      method: 'GET',\n      headers: getBasicAuthHeaders(db),\n    }, options.ajax || {});\n  \n    let res:PouchDBUserDoc = await doFetch(db, url, ajaxOpts);\n    return res;\n  } catch(err) {\n    throw err;\n  }\n};\n\nconst putUser = async function (username:string, opts:PutUserOptions):Promise<BasicResponse> {\n  try {\n    debuglogemph(`PouchDB.putUser(): Called for '${username}'`);\n    let db:PDB = this;\n    let options:any = opts != undefined ? opts : {};\n    if(['http', 'https'].indexOf(db.type()) === -1) {\n      let err:AuthError = new AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB(\"http://mysite.com:5984/mydb\") instead.');\n      throw err;\n    } else if(!username) {\n      let err:AuthError = new AuthError('You must provide a username');\n      throw err;\n    }\n  \n    let user:PouchDBUserDoc = await db.getUser(username, options);\n    let res:BasicResponse = await updateUser(db, user, options);\n    return res;\n  } catch(err) {\n    throw err;\n  }\n};\n\nconst deleteUser = async function(username:string, opts:LoginOptions):Promise<BasicResponse> {\n  try {\n    debuglogemph(`PouchDB.deleteUser(): Called for '${username}'`);\n    let db:PDB = this;\n    let options:any = opts != undefined ? opts : {};\n    if (['http', 'https'].indexOf(db.type()) === -1) {\n      let err:AuthError = new AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB(\"http://mysite.com:5984/mydb\") instead.');\n      throw err;\n    } else if(!username) {\n      let err:AuthError = new AuthError('You must provide a username');\n      throw err;\n    }\n  \n    let user:PouchDBUserDoc = await db.getUser(username, options);\n    let url:string = '/_users/' + encodeURIComponent(user._id) + '?rev=' + user._rev;\n    let ajaxOpts:any = assign({\n      method: 'DELETE',\n      headers: getBasicAuthHeaders(db),\n    }, options.ajax || {});\n    let res:BasicResponse = await doFetch(db, url, ajaxOpts);\n    return res;\n  } catch(err) {\n    throw err;\n  }\n};\n\nconst changePassword = async function(username:string, password:string, opts:LoginOptions):Promise<BasicResponse> {\n  try {\n    debuglogemph(`PouchDB.changePassword(): Called for '${username}'`);\n    let db:PDB = this;\n    let options:any = opts != undefined ? opts : {};\n    if(['http', 'https'].indexOf(db.type()) === -1) {\n      let err:AuthError = new AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB(\"http://mysite.com:5984/mydb\") instead.');\n      throw err;\n    } else if(!username) {\n      let err:AuthError = new AuthError('You must provide a username');\n      throw err;\n    } else if(!password) {\n      let err:AuthError = new AuthError('You must provide a password');\n      throw err;\n    }\n\n    let user:PouchDBUserDoc = await db.getUser(username, options);\n    user.password = password;\n    let url:string = '/_users/' + encodeURIComponent(user._id);\n    let ajaxOpts:any = assign({\n      method: 'PUT',\n      headers: getBasicAuthHeaders(db),\n      body: user,\n    }, options.ajax || {});\n    let res:BasicResponse = await doFetch(db, url, ajaxOpts);\n    return res;\n  } catch(err) {\n    throw err;\n  }\n};\n\nconst changeUsername = async function(oldUsername:string, newUsername:string, opts:PutUserOptions):Promise<BasicResponse> {\n  try {\n    debuglogemph(`PouchDB.changeUsername(): Called for '${oldUsername}' => '${newUsername}'`);\n    let db:PDB = this;\n    let options:any = opts != undefined ? opts : {};\n    let USERNAME_PREFIX:string = 'org.couchdb.user:';\n    const fetch = async function(url:string, opts:LoginOptions):Promise<BasicResponse> {\n      try {\n        let options:any = opts != undefined ? opts : {};\n        let res:BasicResponse = await doFetch(db, url, options);\n        return res; \n      } catch(err) {\n        throw err;\n      }\n    };\n    const updateUser = async function(user:PouchDBUserDoc, opts:LoginOptions):Promise<BasicResponse> {\n      try {\n        let options:any = opts != undefined ? opts : {};\n        let url:string = '/_users/' + encodeURIComponent(user._id);\n        let updateOpts:any = assign({\n          method: 'PUT',\n          headers: getBasicAuthHeaders(db),\n          body: user,\n        }, options.ajax || {});\n    \n        let res:BasicResponse = await fetch(url, updateOpts);\n        return res;\n      } catch(err) {\n        throw err;\n      }\n    };\n    options.ajax = options.ajax || {};\n    if(['http', 'https'].indexOf(db.type()) === -1) {\n      let err:AuthError = new AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB(\"http://mysite.com:5984/mydb\") instead.');\n      throw err;\n    }\n    if(!newUsername) {\n      let err:AuthError = new AuthError('You must provide a new username');\n      throw err;\n    }\n    if(!oldUsername) {\n      let err:AuthError = new AuthError('You must provide a username to rename');\n      throw err;\n    }\n    try {\n      let res:PouchDBUserDoc = await db.getUser(newUsername, options);\n      let err:AuthError = new AuthError('user already exists');\n      err.taken = true;\n      throw err;\n    } catch(err) {\n      try {\n        let user:PouchDBUserDoc = await db.getUser(oldUsername, options);\n        let newUser:PouchDBUserDoc = clone(user);\n        delete newUser._rev;\n        newUser._id = USERNAME_PREFIX + newUsername;\n        newUser.name = newUsername;\n        newUser.roles = options.roles || user.roles || [];\n        let res:BasicResponse = await updateUser(newUser, options);\n        user._deleted = true;\n        res = await updateUser(user, options);\n        return res;\n      } catch(err) {\n        throw err;\n      }\n    }\n  } catch(err) {\n    throw err;\n  }\n};\n\nexport {\n  getUsersDatabaseUrl,\n  signUp,\n  getUser,\n  putUser,\n  deleteUser,\n  changePassword,\n  changeUsername,\n  getRoles,\n  addRoles,\n  deleteRoles,\n  hasRole,\n};\n","declare const window:any;\n\nimport { deleteAdmin, getMembership, signUpAdmin } from \"./admins\";\nimport { getSession, logIn, logOut } from \"./authentication\";\nimport {\n  changePassword,\n  changeUsername,\n  deleteUser,\n  getUser,\n  getUsersDatabaseUrl,\n  putUser,\n  signUp,\n  getRoles,\n  addRoles,\n  deleteRoles,\n  hasRole,\n} from \"./users\";\n\nconst PouchDBAuthPlugin:any = {\n  login               : logIn               ,\n  logIn               : logIn               ,\n  logout              : logOut              ,\n  logOut              : logOut              ,\n  getSession          : getSession          ,\n  getMembership       : getMembership       ,\n  signUpAdmin         : signUpAdmin         ,\n  deleteAdmin         : deleteAdmin         ,\n  getUsersDatabaseUrl : getUsersDatabaseUrl ,\n  signup              : signUp              ,\n  signUp              : signUp              ,\n  getUser             : getUser             ,\n  putUser             : putUser             ,\n  deleteUser          : deleteUser          ,\n  changePassword      : changePassword      ,\n  changeUsername      : changeUsername      ,\n  getRoles            : getRoles            ,\n  addRoles            : addRoles            ,\n  deleteRoles         : deleteRoles         ,\n  hasRole             : hasRole             ,\n};\n\nconst plugin:any = PouchDBAuthPlugin;\nexport { plugin };\n// let var plugin:any = {};\n// plugin.login = logIn;\n// plugin.logIn = logIn;\n// plugin.logout = logOut;\n// plugin.logOut = logOut;\n// plugin.getSession = getSession;\n\n// plugin.getMembership = getMembership;\n// plugin.signUpAdmin = signUpAdmin;\n// plugin.deleteAdmin = deleteAdmin;\n\n// plugin.getUsersDatabaseUrl = getUsersDatabaseUrl;\n// plugin.signup = signUp;\n// plugin.signUp = signUp;\n// plugin.getUser = getUser;\n// plugin.putUser = putUser;\n// plugin.deleteUser = deleteUser;\n// plugin.changePassword = changePassword;\n// plugin.changeUsername = changeUsername;\n// export class PouchDBPlugin {\n//   public login = logIn;\n//   public logIn = logIn;\n//   public logout = logOut;\n//   public logOut = logOut;\n//   public getSession = getSession;\n//   public getMembership = getMembership;\n//   public signUpAdmin = signUpAdmin;\n//   public deleteAdmin = deleteAdmin;\n//   public getUsersDatabaseUrl = getUsersDatabaseUrl;\n//   public signup = signUp;\n//   public signUp = signUp;\n//   public getUser = getUser;\n//   public putUser = putUser;\n//   public deleteUser = deleteUser;\n//   public changePassword = changePassword;\n//   public changeUsername = changeUsername;\n//   constructor() {\n\n//   }\n// }\n\n// // let plugin:any = PouchDBPlugin;\n// let plugin:PouchDBPlugin = new PouchDBPlugin();\n\n// if(typeof window !== 'undefined' && window.PouchDB) {\n//   window.PouchDB.plugin(PouchDBAuthPlugin);\n// }\n\n// export default plugin;\n// export plugin;\n"],"names":["arguments","tslib_1.__extends","PouchDB.emit","tslib_1.__values","parseUri","btoa","Headers","assign","clone"],"mappings":"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"}